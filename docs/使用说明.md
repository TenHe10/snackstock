# SnackStock 产品使用说明

## 1. 产品简介

SnackStock 是一个面向零食门店的本地库存管理工具，支持：

- 商品档案管理
- 入库（支持批次与保质期）
- 出库结算（购物车模式）
- 缺货/临期预警
- 日报统计与 CSV 导出

---

## 2. 安装与启动

### 2.1 环境要求

- Python 3.13+
- Windows / macOS / Linux（当前为本地桌面运行）

### 2.2 安装依赖

```bash
uv sync
```

或：

```bash
pip install -r requirements.txt
```

### 2.3 启动系统

```bash
uv run python main.py
```

首次启动会自动创建数据库文件：

- `database/inventory.db`

---

## 3. 界面结构与切换

系统顶部提供 3 个功能页签，可快速切换：

1. 入库
2. 出库
3. 库存与报表

建议按“先建档，再入库，再出库”的顺序使用。

---

## 4. 入库功能（入库页）

入库页包含两块区域：`商品档案` + `入库扫码`。

### 4.1 新增/更新商品档案

在“商品档案”填写：

- 条码（必填）
- 名称（必填）
- 分类
- 进价
- 售价
- 安全库存

点击 `新增/更新商品` 保存。

### 4.2 扫码入库

在“入库扫码”填写：

- 条码
- 数量
- 批次（建议填写）
- 过期日期（建议填写）

点击 `确认入库` 后：

- 增加入库日志
- 若填写了批次和过期日期，会写入保质期批次库存

---

## 5. 出库功能（出库页）

### 5.1 加入购物车

在“出库扫码”输入：

- 条码（扫码枪输入后回车可自动加入）
- 数量

点击 `加入购物车`。

若商品不存在，系统会提示并引导到入库页先创建商品档案。

### 5.2 结算

在“出库购物车”点击 `结算` 后：

- 扣减库存
- 生成销售日志
- 更新营业额与毛利润显示

系统会在结算时检查库存，不足会提示并阻止结算。

---

## 6. 库存与报表（库存与报表页）

### 6.1 库存与预警

页面展示：

- 当前库存表（条码、名称、分类、库存、安全库存）
- 预警信息（缺货预警、临期预警）

系统启动时若存在预警，会弹窗汇总提示。

### 6.2 日报统计

页面显示当天：

- 营业额
- 进货额
- 毛利润

### 6.3 导出日报 CSV

操作步骤：

1. 选择报表日期
2. 点击 `导出日报 CSV`
3. 选择保存目录

导出文件名格式：

- `daily_report_YYYY-MM-DD.csv`

---

## 7. 业务规则说明

- 出库扣减批次时，按“到期日优先”（FIFO-by-expiry）扣减已登记批次库存。
- 若历史库存未登记批次，仍可正常出库，但该部分不会体现在批次扣减明细中。
- 所有数据存储在本地 SQLite 文件中，无网络依赖。

---

## 8. 常见问题

### 8.1 扫码无反应

- 确认扫码枪为 HID 键盘模式
- 确认光标位于条码输入框
- 确认扫码后带回车

### 8.2 提示“商品不存在”

请先在“入库 > 商品档案”创建该条码商品。

### 8.3 导出失败

- 检查目标目录是否有写权限
- 关闭同名 CSV 文件后重试

---

## 9. 数据备份建议

每日或每周备份以下文件：

- `database/inventory.db`

恢复时将备份文件覆盖同路径数据库即可。
